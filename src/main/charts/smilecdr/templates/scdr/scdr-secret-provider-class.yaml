{{- if eq ((include "sscsi.enabled" . ) | trim ) "true" -}}
apiVersion: secrets-store.csi.x-k8s.io/v1
kind: SecretProviderClass
metadata:
  name: {{ include "sscsi.secretProviderClassName" . | lower }}
  namespace: {{ .Release.Namespace }}
spec:
  provider: {{ default (.Values.image.credentials).provider "aws" }}
  parameters:
    objects: |
      {{ include "sscsi.objects" . | nindent 6 | trim }}
  secretObjects:
  {{ include "sscsi.secretObjects" . | nindent 2 | trim }}
{{- end -}}

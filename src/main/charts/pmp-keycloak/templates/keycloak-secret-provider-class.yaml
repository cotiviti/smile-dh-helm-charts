{{- if eq ((include "sdhCommon.sscsi.enabled" . ) | trim ) "true" -}}
apiVersion: secrets-store.csi.x-k8s.io/v1
kind: SecretProviderClass
metadata:
  name: {{ include "sdhCommon.sscsi.secretProviderClassName" . | lower }}
  labels:
    {{- include "keycloak.labels" $ | nindent 4 }}
  namespace: {{ .Release.Namespace }}
spec:
  provider: {{ default (.Values.image.credentials).provider "aws" }}
  parameters:
    objects: |
      {{ include "sdhCommon.sscsi.objects" . | nindent 6 | trim }}
  secretObjects:
  {{ include "sdhCommon.sscsi.syncedSecrets" . | nindent 2 | trim }}
{{- end -}}

oldResourceNaming: false
cdrNodes:
  masterdev:
    enabled: false
  admin:
    name: AdminNode
    enabled: true
    logsDirSize: 5Gi
    mappedFiles:
      logback-a.xml:
        fileName: logback.xml
        path: /home/smile/smilecdr/classes
    modules:
      useDefaultModules: false
      clustermgr:
        name: Cluster Manager Configuration
        enabled: true
        config:
          # Valid options include H2_EMBEDDED, DERBY_EMBEDDED, MYSQL_5_7, MARIADB_10_1, POSTGRES_9_4, ORACLE_12C, MSSQL_2012
          db.driver: POSTGRES_9_4
          db.url: jdbc:postgresql://#{env['DB_URL']}:#{env['DB_PORT']}/#{env['DB_DATABASE']}?sslmode=require
          db.password: "#{env['DB_PASS']}"
          db.username: "#{env['DB_USER']}"
          db.schema_update_mode:  UPDATE

      admin_json:
        name: JSON Admin Services
        enabled: true
        type: ADMIN_JSON
        service:
          enabled: true
          svcName: admin-json
        requires:
          SECURITY_IN_UP: local_security
        config:
          context_path: json-admin
          port: 9000

      local_security:
        name: Local Storage Inbound Security
        enabled: true
        type: SECURITY_IN_LOCAL

      admin_web:
        name: Web Admin
        enabled: true
        type: ADMIN_WEB
        enableReadinessProbe: true
        service:
          enabled: true
          svcName: admin-web
          hostName: default
        requires:
          SECURITY_IN_UP: local_security
        config:
          context_path: ""
          port: 9100

      audit:
        name: External Audit DB Config
        enabled: true
        type: AUDIT_LOG_PERSISTENCE
        config:
          db.driver: POSTGRES_9_4
          db.url: jdbc:postgresql://#{env['DB_URL']}:#{env['DB_PORT']}/#{env['DB_DATABASE']}?sslmode=require
          db.password: "#{env['DB_PASS']}"
          db.username: "#{env['DB_USER']}"
          db.schema_update_mode:  UPDATE

      transaction:
        name: External Transaction Log DB
        enabled: true
        type: TRANSACTION_LOG_PERSISTENCE
        config:
          db.driver: POSTGRES_9_4
          db.url: jdbc:postgresql://#{env['DB_URL']}:#{env['DB_PORT']}/#{env['DB_DATABASE']}?sslmode=require
          db.username: "#{env['DB_USER']}"
          db.password: "#{env['DB_PASS']}"
          db.schema_update_mode: UPDATE
  fhir:
    name: FhirNode
    enabled: true
    logsDirSize: 10Gi
    config:
      locked: true
      troubleshooting: false
    security:
      strict: false
    mappedFiles:
      fileWithNameOverride2.js:
        fileName: theRequiredFileName.txt
        path: /home/smile/smilecdr/classes
    modules:
      useDefaultModules: false
      clustermgr:
        name: Cluster Manager Configuration
        enabled: true
        config:
          # Valid options include H2_EMBEDDED, DERBY_EMBEDDED, MYSQL_5_7, MARIADB_10_1, POSTGRES_9_4, ORACLE_12C, MSSQL_2012
          db.driver: POSTGRES_9_4
          db.url: jdbc:postgresql://#{env['DB_URL']}:#{env['DB_PORT']}/#{env['DB_DATABASE']}?sslmode=require
          db.password: "#{env['DB_PASS']}"
          db.username: "#{env['DB_USER']}"
          db.schema_update_mode:  NONE

      persistence:
        name: Database Configuration
        enabled: true
        type: PERSISTENCE_R4
        config:
          db.driver: POSTGRES_9_4
          db.url: jdbc:postgresql://#{env['DB_URL']}:#{env['DB_PORT']}/#{env['DB_DATABASE']}?sslmode=require
          db.password: "#{env['DB_PASS']}"
          db.username: "#{env['DB_USER']}"
          db.schema_update_mode: NONE

      local_security:
        name: Local Storage Inbound Security
        enabled: true
        type: SECURITY_IN_LOCAL

      # Fhir Endpoint
      fhir_endpoint:
        name: FHIR Service
        enabled: true
        type: ENDPOINT_FHIR_REST
        enableReadinessProbe: true
        service:
          enabled: true
          svcName: fhir
          hostName: default
        requires:
          PERSISTENCE_ALL: persistence
          SECURITY_IN_UP: local_security
        config:
          context_path: fhir_request
          port: 8000

      audit:
        name: External Audit DB Config
        enabled: true
        type: AUDIT_LOG_PERSISTENCE
        config:
          db.driver: POSTGRES_9_4
          db.url: jdbc:postgresql://#{env['DB_URL']}:#{env['DB_PORT']}/#{env['DB_DATABASE']}?sslmode=require
          db.password: "#{env['DB_PASS']}"
          db.username: "#{env['DB_USER']}"
          db.schema_update_mode:  NONE

      transaction:
        name: External Transaction Log DB
        enabled: true
        type: TRANSACTION_LOG_PERSISTENCE
        config:
          db.driver: POSTGRES_9_4
          db.url: jdbc:postgresql://#{env['DB_URL']}:#{env['DB_PORT']}/#{env['DB_DATABASE']}?sslmode=require
          db.username: "#{env['DB_USER']}"
          db.password: "#{env['DB_PASS']}"
          db.schema_update_mode: NONE

mappedFiles:
  fileWithNameOverride.js:
    fileName: theRequiredFileName.txt
    path: /home/smile/smilecdr/classes
  someOtherFile.js:
    path: /home/smile/smilecdr/classes
  logback.xml:
    path: /home/smile/smilecdr/classes


ingresses:
  default:
    enabled: true
